<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Form page</title>
</head>

<body>
  <form>
    <label for="file-input">Browse your files:</label>
    <input id="file-input" type="file" />
  </form>
  <button id="submit-button">submit file</button>
  <div id="message"></div>
</body>

<script>
  document.getElementById('submit-button').addEventListener('click', e => {
    let body;
    if (new URLSearchParams(location.search).has('multipart')) {
      body = new FormData;
      body.append('file', document.querySelector('[type=file]').files[0]);
    } else {
      body = new URLSearchParams({ text: 'simply_some_text' });
    }
    const messageDiv = document.querySelector('#message');
    fetch('/api/foo', {
      method: 'POST',
      body,
    }).then(async response => {
      const text = await response.text();
      console.log(`[browser]: response payload size: ${text.length}`);
      messageDiv.textContent = 'Your POST request was successful! ;D';
      messageDiv.style.backgroundColor = 'green';
    }).catch(error => {
      console.log(`[browser]: error: ${error.message}`);
      messageDiv.textContent = error.message;
      messageDiv.style.backgroundColor = 'red';
    });
  });
</script>

</html>